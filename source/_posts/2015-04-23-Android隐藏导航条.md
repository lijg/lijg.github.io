---
title: Android隐藏导航条
date: 2015-04-23 22:51:52
tags:
- 导航条
categories:
- Android
---

目的：实现程序控制隐藏和显示Android导航条

适用版本: Android 4.2+

涉及文件: `(AndroidSrc)/framework/base/packages/SystemUI/src/com/android/systemui/statusbar/phone/PhoneStatusBar.java`

修改内容:

```
--- a/packages/SystemUI/src/com/android/systemui/statusbar/phone/PhoneStatusBar.java
+++ b/packages/SystemUI/src/com/android/systemui/statusbar/phone/PhoneStatusBar.java
@@ -153,6 +153,8 @@ public class PhoneStatusBar extends BaseStatusBar implements DemoMode {
     private float mFlingGestureMaxOutputVelocityPx; // how fast can it really go? (should be a little
                                                     // faster than mSelfCollapseVelocityPx)
 
+    private boolean isDisplayNavBar;
+
     PhoneStatusBarPolicy mIconPolicy;
 
     // These are no longer handled by the policy, because we need custom strategies for them
@@ -349,6 +351,7 @@ public class PhoneStatusBar extends BaseStatusBar implements DemoMode {
         super.start(); // calls createAndAddWindows()
 
         addNavigationBar();
+        isDisplayNavBar = true;
 
         // Lastly, call to the icon policy to install/update all the icons.
         mIconPolicy = new PhoneStatusBarPolicy(mContext);
@@ -645,6 +648,10 @@ public class PhoneStatusBar extends BaseStatusBar implements DemoMode {
         filter.addAction(ACTION_DEMO);
         context.registerReceiver(mBroadcastReceiver, filter);
 
+        IntentFilter filter1 = new IntentFilter();
+        filter1.addAction("ACTION_STATUS_BAR_CTRL");
+        context.registerReceiver(mBroadcastReceiver1, filter1);
+
         // listen for USER_SETUP_COMPLETE setting (per-user)
         resetUserSetupObserver();
 
@@ -806,6 +813,11 @@ public class PhoneStatusBar extends BaseStatusBar implements DemoMode {
         mWindowManager.addView(mNavigationBarView, getNavigationBarLayoutParams());
     }
 
+    private void removeNavigationBar() {
+        if(mNavigationBarView == null) return;
+        mWindowManager.removeView(mNavigationBarView);
+    }
+
     private void repositionNavigationBar() {
         if (mNavigationBarView == null || !mNavigationBarView.isAttachedToWindow()) return;
 
@@ -2443,6 +2455,26 @@ public class PhoneStatusBar extends BaseStatusBar implements DemoMode {
         }
     };
 
+    private BroadcastReceiver mBroadcastReceiver1 = new BroadcastReceiver() {
+        public void onReceive(Context context, Intent intent) {
+            String action = intent.getAction();
+            if (isOrderedBroadcast()) {  
+                if (action.equals("ACTION_STATUS_BAR_CTRL")) {  
+                    String cmd = intent.getStringExtra("cmd");
+                    if(cmd.equals("hide") && isDisplayNavBar ) {  
+                        isDisplayNavBar=false;  
+                        removeNavigationBar();
+                    } else if(cmd.equals("show")&&!isDisplayNavBar){  
+                        isDisplayNavBar=true;  
+                        addNavigationBar();
+                    }
+                }
+                this.abortBroadcast();
+            }
+        }
+    };
+      
+
     private BroadcastReceiver mBroadcastReceiver = new BroadcastReceiver() {
         public void onReceive(Context context, Intent intent) {
             if (DEBUG) Log.v(TAG, "onReceive: " + intent);
```
