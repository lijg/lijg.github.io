---
title: Android广播用法简介
date: 2014-03-20 18:56:54
tags:
- 广播
categories:
- Android
---

#1 什么是广播
广播类似于设计模式中的观察者模式，主要用于进程（不同的类、模块、层次）间的消息或事件传递。广播发起者不用关心哪些模块会接收消息以及他们的动作，只需要发出消息即可；接收方不知道信息的发起者，只需要定义好当接收到广播后需要做的事情。

#2 广播的种类
* 普通广播
    这种广播可以依次传递给各个接收器去处理。
* 有序广播
    这种广播在接收器端的处理顺序是按照接收器的不同优先级来区分的，高优先级的接收器会优先截获这个消息，并且可以将这个消息删除。
* 粘性消息
    粘性消息在发送后就一直存在于系统的消息容器里面，等待对应的处理器去处理，如果暂时没有接收器处理这个消息则一直在消息容器里面处于等待状态。
* 注意：普通广播和粘性消息不可以被截获，而有序广播是可以被截获的，

#1 接收方
##1.1 注册广播接收器
```java
private BroadcastReceiver myBroadcastReceiver = new BroadcastReceiver() {    
    @Override  
    public void onReceive(Context context, Intent intent) {  
        String action = intent.getAction();  
        if (isOrderedBroadcast()) {  
            // 收到一个有序广播
            if (action.equals("myAction")) {  
                // 广播指定的动作是"myAction"
                
                String cmd = intent.getStringExtra("cmd");  
                // 该Action附带的cmd字段内容是：
                
                if(cmd.equals("hide")){  
                    // 广播附带hide消息 
                }else if(cmd.equals("show")){  
                    // 广播附带show消息  
                }
                
                this.abortBroadcast();
                // 截断该广播
            } else {
                // 收到错误的广播
            }
        } else {
            // 这不是一个有序广播
        }
    }
};
```
##1.2 关联广播和接收器
```java
    IntentFilter myFilter = new IntentFilter();  
    myFilter.addAction("myAction");  
    context.registerReceiver(myBroadcastReceiver, myFilter);  
    // 该接收器只关心myAction类型的广播
```
#2 发送方
```java
    Intent intent=new Intent();  
    intent.setAction("myAction");  
    intent.putExtra("cmd","hide");  
    
    this.sendBroadcast(intent); // 发送普通广播
    this.sendOrderedBroadcast(intent,null);  //发送有序广播
    this.sendStickyBroadcast(intent);   // 发送粘性广播
```

完。