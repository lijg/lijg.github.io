---
title: Python串口通信
date: 2015-05-16 22:20:12
tags:
- Python
- 嵌入式
categories:
- Linux
---
Python下进行串口通信要用到[pySerial](http://pyserial.sourceforge.net/)。

> This module encapsulates the access for the serial port. It provides backends for Python running on Windows, Linux, BSD (possibly any POSIX compliant system), Jython and IronPython (.NET and Mono). The module named “serial” automatically selects the appropriate backend.

> 这个模块封装了串口操作。支持Windows、LinuxBSD（其他POSIX兼容系统）、Jython和IronPython(.NET及Mono)等。

##特性
* 所有平台上统一的接口
* 通过Python属性即可配置端口
* 支持不通的字长、停止位、校验位和基于RTSD/CTS及(或)Xon/Xoff的流控
* 支持读取超时
* 类文件读写API，常见的read、write等接口（也支持readline等）
* 100% Python实现
* 使用二进制模式传输，没有`NULL`字符及`CR-LF`等，从而兼容`io`库。
*

##需求
* Python >= 2.3
* Windows平台下需要ctypes支持(从Python 2.5开始是标准库的一部分)
* Java/Jython上的 "Java Communications" (JavaComm)或者兼容包

##使用方法

####1 打开串口0，模式:“9600,8,N,1”, 无超时:
```
>>> import serial
>>> ser = serial.Serial(0)  # 打开串口0
>>> print ser.name          # check which port was really used
>>> ser.write("hello")      # 写字符串
>>> ser.close()             # 关闭串口
```

####2 打开特定的串口，模式：“19200,8,N,1”, 超时：1s:
```
>>> ser = serial.Serial('/dev/ttyS1', 19200, timeout=1)
>>> x = ser.read()          # 读一个字节
>>> s = ser.read(10)        # 读10个字节
>>> line = ser.readline()   # 读一行
>>> ser.close()
```

####4 打开串口1，模式：“38400,8,E,1”, non blocking HW handshaking:
```
>>> ser = serial.Serial(1, 38400, timeout=0, parity=serial.PARITY_EVEN, rtscts=1)
>>> s = ser.read(100)       # read up to one hundred bytes or as much is in the buffer
```


####5 配置串口
```
>>> ser = serial.Serial()
>>> ser.baudrate = 19200
>>> ser.port = 0
>>> ser
Serial<id=0xa81c10, open=False>(port='COM1', baudrate=19200, bytesize=8, parity='N', stopbits=1, timeout=None, xonxoff=0, rtscts=0)
>>> ser.open()
>>> ser.isOpen()
True
>>> ser.close()
>>> ser.isOpen()
False
```

####6 可用方法
```
open()                  # 打开端口
close()                 # 立即关闭端口  
setBaudrate(baudrate)   # change baud rate on an open port  
inWaiting()             # return the number of chars in the receive buffer  
read(size=1)            # read "size" characters  
write(s)                # 把字符串s写到该端口  
flushInput()            # 清除输入缓存区，放弃所有内容
flushOutput()           # 清除输出缓冲区，放弃输出  
sendBreak()             # 发送中断条件  
setRTS(level=1)         # set RTS line to specified logic level  
setDTR(level=1)         # set DTR line to specified logic level  
getCTS()                # return the state of the CTS line  
getDSR()                # return the state of the DSR line  
getRI()                 # return the state of the RI line  
getCD()                 # return the state of the CD line
```

####7 属性
**只读**
```
portstr                 # 设备名称  
BAUDRATES               # list of valid baudrates  
BYTESIZES               # list of valid byte sizes  
PARITIES                # list of valid parities  
STOPBITS                # list of valid stop bit widths  
```
**下面属性值被更改后端口会重新配置，即使端口已经打开**
```
port                    # port name/number as set by the user  
baudrate                # current baud rate setting  
bytesize                # byte size in bits  
parity                  # parity setting  
stopbits                # stop bit with (1,2)  
timeout                 # timeout setting  
xonxoff                 # if Xon/Xoff flow control is enabled  
rtscts                  # if hardware flow control is enabled  
```

####8 异常
```
serial.SerialException  
```

####9 常量
**校验**
```
serial.PARITY_NONE  
serial.PARITY_EVEN  
serial.PARITY_ODD  
```
**停止位**
```
serial.STOPBITS_ONE  
serial.STOPBITS_TWO 
```

**字长**
```
serial.FIVEBITS  
serial.SIXBITS  
serial.SEVENBITS  
serial.EIGHTBITS  
```
